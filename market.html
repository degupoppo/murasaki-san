
<!DOCTYPE html>
<html lang="en">

<script src="lib/web3.min.js"></script>
<script src="src/js_info/murasaki_item_market.js"></script>
<script src="src/js_info/murasaki_craft.js"></script>
<script src="src/js_info/array_item_name.js"></script>
<script src="src/js_info/array_item_png.js"></script>
<script src="src/js_info/murasaki_main.js"></script>
<script src="src/js_info/murasaki_function_name.js"></script>
<script src="src/js_info/murasaki_function_crafting.js"></script>

<script src="src/js/share.js"></script>
<script src="src/js/market.js"></script>

<head>
	<meta charset="UTF-8">
	<title>Murasaki-san Item Market</title>
	<link rel="stylesheet" type="text/css" href="lib/datatables.min.css"/>
	<script type="text/javascript" language="javascript" src="lib/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" language="javascript" src="lib/datatables.min.js"></script>
    <link rel="stylesheet" href="src/css/simple.css">
    <link rel="stylesheet" href="src/css/style.css">
    <link rel="stylesheet" href="src/css/datatable.css">
    <link rel="icon" href="src/png/favicon.png" />
    <link rel="apple-touch-icon" href="src/png/favicon.png">
</head>

<body>

<header>
    <nav>
      <a href="index.html">&#x1f3e0; Home</a>
      <a href="house.html" ><b>&#x1f497; Play</b></a>
      <a href="market.html" class="current"><b>&#x1f6d2; Market</b></a>
      <a href="house.html?summoner=1">&#x1f530; Demo</a>
      <a href="https://twitter.com/degupoppo" >Twitter</a>
      <a href="https://github.com/degupoppo/murasakisan/" >GitHub</a>
    </nav>
    <h1>
        <img src="src/png/item_basic_sweet_potato.png" width="40" height="40">
        Item Market Place
        <img src="src/png/item_basic_sweet_potato.png" width="40" height="40">
    </h1>
    <p><code class="language-plaintext highlighter-rouge">
        You can buy and sell crafted item NFTs here.<br>
        All transaction fees are 1%. <br>
    </p></code>
</header>

<main>

    <h3>Item Market &#127873;</h3>
	<table id="table_onMarketItems" class="display">
		<thead><tr>
			<th style="width:50px;"><center>item_id</center></th>
			<th><center>item_type</center></th>
            <th><center>item_rarity</center></th>
			<th><center>crafted_by</center></th>
			<th><center>Price ($ASTR)</center></th>
			<th><center>action</center></th>
		</tr></thead>
		<tbody id="tbody_sellingItems"></tbody>
	</table>

    <h3>Your Sellings &#127926;</h3>
	<table id="talbe_sellingItems" class="display">
		<thead><tr>
			<th style="width:50px;"><center>item_id</center></th>
			<th><center>item_type</center></th>
            <th><center>item_rarity</center></th>
			<th><center>crafted_by</center></th>
			<th><center>Price ($ASTR)</center></th>
			<th><center>action</center></th>
		</tr></thead>
		<tbody id="tbody_listedItems"></tbody>
	</table>

    <h3>Your Items &#127752;</h3>
    <p><code class="language-plaintext highlighter-rouge">
        Before selling, please approve the Market Contract:
        <button id="button_approve" onclick='approve();'>Approve</button><br>
    </code></p>
	<table id="table_userItems" class="display">
	    <thead><tr>
            <th style="width:50px;"><center>item_id</center></th>
            <th><center>item_type</center></th>
            <th><center>item_rarity</center></th>
            <th><center>crafted_by</center></th>
            <th><center>sell Price ($ASTR)</center></th>
        </tr></thead>
        <tbody id="tbody_myItems"></tbody>
	</table>

	<p>
	<b>&#127872; Send Item &#127872;</b><br>
	Transfer your items to other Murasaki-san:<br>
    item_id: <input type="number" id="transfer_item_id" style="width:80px;">
    &nbsp;&nbsp;to Murasaki-san: <input type="number" id="transfer_summoner" style="width:80px;">
    &nbsp;&nbsp;<button onclick="transfer_item();">Send Item</button>
    </p>

	<p>
	<b>&#127775; Upgrade Item &#127775;</b><br>
	Mint a higher rarity item by <u>burning 3 items</u> with the same item_type and rarity:<br>
	Ex) <font color="green">three common Violins</font> <b>-></b> <font color="blue">one uncommon Violin</font><br>
    item_ids: <input type="number" id="upgrade_item_id1" style="width:80px;">
    &nbsp;<input type="number" id="upgrade_item_id2" style="width:80px;">
    &nbsp;<input type="number" id="upgrade_item_id3" style="width:80px;">
    &nbsp;&nbsp;<button id="button_approve_upgrade" onclick="approve_upgrade();">Approve</button>
    &nbsp;&nbsp;<button onclick="upgrade_item();">Burn & Upgrade</button>
    </p>

    <script>
        //active JQuery Datatable
        //TOFIX: using JSON!
        update_onMarketItems();
        update_sellingItems();
        update_userItems();
        check_approve();
        check_approve_upgrade();
    </script>

</main>

<footer>
        Developper's wallet: 0x2F7448B62134e52C2f46454d0089Ae21B5248805<br>
        Donation:
        &nbsp;
        <button style="height:28px;font-size:80%" onclick="donate(1);">
            <script type="text/javascript">write_icon(1)</script>&nbsp;1 $ASTR
        </button>
        &nbsp;
        <button style="height:28px;font-size:80%" onclick="donate(10);">
            <script type="text/javascript">write_icon(10)</script>&nbsp;10 $ASTR
        </button>
        &nbsp;
        <button style="height:28px;font-size:80%" onclick="donate(100);">
            <script type="text/javascript">write_icon(100)</script>&nbsp;100 $ASTR
        </button>
</footer>

</body>
</html>
